document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("#adress"),t=new URLSearchParams(window.location.search).get("adress");let n=null;function s(e){fetch("adresses.json").then((e=>e.json())).then((t=>{console.log(t);const n=t.find((t=>t.id===e));if(console.log(n),!n)return;const s=(new Date).getDay();daysMap=["нд","пн","вт","ср","чт","пт","сб"],todayName=daysMap[s],isDayMatch=n.grafick.includes(todayName);const a=new Date,[o,r]=n.time.split(" - "),[c,d]=o.split(":").map(Number),[i,l]=r.split(":").map(Number),u=new Date;u.setHours(c,d,0,0);const m=new Date;m.setHours(i,l,0,0);const p=a>=u&&a<=m;document.querySelector(".price_pb p").innerHTML=`${isDayMatch&&p?n.pb:"0₴"} <span>/година</span>`;document.querySelector(".price_unip p").innerHTML=`${isDayMatch&&p?n.unip:"0₴"} <span>/година</span>`;document.querySelector(".mask_pb").href=n.linkPB;document.querySelector(".mask_unip").href=n.linkUNIp;document.querySelector(".map").innerHTML=n.iframe;const y=n.terminalAdress.map((e=>{const t=e.value.match(/^(.+?)\((.+)\)$/);return t?{key:e.key,address:t[1].trim(),info:t[2].trim()}:{key:e.key,address:e.value.trim(),info:""}})),h={};y.forEach((e=>{h[e.key]||(h[e.key]=[]),h[e.key].push({address:e.address,info:e.info})})),document.querySelector(".adress_text").innerHTML="";for(const e in h){const t=document.createElement("p");t.classList.add("adress_id"),t.textContent=e,document.querySelector(".adress_text").appendChild(t),h[e].forEach((e=>{const t=document.createElement("p");t.classList.add("adress_text_terminal");const n=document.createElement("span");n.textContent="("+e.info+")",t.textContent=e.address+" ",t.appendChild(n),document.querySelector(".adress_text").appendChild(t)}))}})).catch((e=>console.error("JSON load error:",e)))}t?(e.value=t,n=t):n=e&&e.value?e.value:"ХМ001",s(n),e.addEventListener("change",(function(){const t=e.value,n=`${window.location.pathname}?adress=${t}`;console.log(t),window.history.pushState({},"",n),s(t)}))}));